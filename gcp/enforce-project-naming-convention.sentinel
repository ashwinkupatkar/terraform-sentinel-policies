import "tfconfig/v2" as tfconfig
import "strings" as s 

print("Ensure allowed project naming convention")

allowed-project-naming-convention = rule {
    filter tfconfig.resource_changes as _, rc {
        rc.mode is "managed" and rc.type is "google_project" and 
        rc.provider_name matches "(.*)google$" and rc.change.actions is ["create"] and
        s.has_prefix((rc.change.after.name), "prj-") 
}

main = rule {
    allowed-project-naming-convention
}
