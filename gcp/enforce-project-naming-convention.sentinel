import "tfconfig/v2" as tfconfig
import "strings" as s 

print("Ensure allowed project naming convention")

print("output:")

print(s.has_prefix("project", "prj-"))

allowed_project_naming_convention = filter tfconfig.resources as _, r {
        r.mode is "managed" and r.type is "google_project" and 
        r.provider_name matches "(.*)google$" and r.change.actions is ["create"]
}

main = rule {
    allowed_project_naming_convention
}
